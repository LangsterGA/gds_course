

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choropleth mapping &#8212; A course on Geographic Data Science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/.ipynb_checkpoints/custom-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  
  <h1 class="site-logo" id="site-title">A course on Geographic Data Science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  Information
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   Bibliography
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  A - Introduction
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../bA/concepts_A.html">
   Concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bA/lab_A.html">
   Hands-on
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bA/diy_A.html">
   Do-It-Yourself
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  B - Open Science
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../bB/concepts_B.html">
   Concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bB/lab_B.html">
   Hands-on
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bB/diy_B.html">
   Do-It-Yourself
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  C - Spatial Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../bC/concepts_C.html">
   Concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bC/lab_C.html">
   Hands-on
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../bC/diy_C.html">
   Do-It-Yourself
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  D - Mapping Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="concepts_D.html">
   Concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lab_D.html">
   Hands-on
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="diy_D.html">
   Do-It-Yourself
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/bD/05_choropleth.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principles">
   Principles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quantitative-data-classification">
   Quantitative data classification
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equal-intervals">
     Equal Intervals
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quantiles">
     Quantiles
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mean-standard-deviation">
     Mean-standard deviation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#maximum-breaks">
     Maximum Breaks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#box-plot">
     Box-Plot
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#head-tail-breaks">
     Head-Tail Breaks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jenks-caspall">
     Jenks Caspall
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fisher-jenks">
     Fisher Jenks
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#max-p">
     Max-p
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#comparing-classification-schemes">
     Comparing Classification schemes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#color">
   Color
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sequential-color-schemes">
     Sequential Color Schemes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diverging-color-schemes">
     Diverging Color Schemes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#qualitative-color-schemes">
     Qualitative Color Schemes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#conclusion">
   Conclusion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions">
   Questions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="choropleth-mapping">
<h1>Choropleth mapping<a class="headerlink" href="#choropleth-mapping" title="Permalink to this headline">¶</a></h1>
<!-- #region -->
<div class="section" id="principles">
<h2>Principles<a class="headerlink" href="#principles" title="Permalink to this headline">¶</a></h2>
<p>Choropleth maps play a prominent role in geographic data science as they allow
us to display non-geographic attributes or variables on a geographic map. The
word choropleth stems from the root “choro”, meaning “region”. As such
choropleth maps represent data at the region level, and are appropriate for
areal unit data where each observation combines a value of an attribute and a
geometric figure, usually a polygon. Choropleth maps derive from an earlier era
where cartographers faced technological constraints that precluded the use of
unclassed maps where each unique attribute value could be represented by a
distinct symbol or color. Instead, attribute values were grouped into a smaller
number of classes, usually not more than 12. Each class was associated with a
unique symbol that was in turn applied to all observations with attribute values
falling in the class.</p>
<p>Although today these technological constraints are no longer binding, and
unclassed mapping is feasible, there are still good reasons for adopting a
classed approach. Chief among these is to reduce the cognitive load involved in
parsing the complexity of an unclassed map. A choropleth map reduces this
complexity by drawing upon statistical and visualization theory to provide an
effective representation of the spatial distribution of the attribute values
across the areal units.</p>
<p>The effectiveness of a choropleth map will be a
function of the choice of classification scheme together with the color or
symbolization strategy adopted. In broad terms, the classification scheme
defines the number of classes as well as the rules for assignment, while the
symbolization should convey information about the value differentiation across
the classes.</p>
<p>In this chapter we first discuss the approaches used to classify attribute
values. This is followed by an overview of color theory and the implications of
different color schemes for effective map design. We combine theory and practice
by exploring how these concepts are implemented in different Python packages,
including <code class="docutils literal notranslate"><span class="pre">geopandas</span></code>, and <code class="docutils literal notranslate"><span class="pre">PySAL</span></code>.</p>
<!-- #endregion -->
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">seaborn</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">import</span> <span class="nn">pysal</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">mapclassify</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="section" id="quantitative-data-classification">
<h2>Quantitative data classification<a class="headerlink" href="#quantitative-data-classification" title="Permalink to this headline">¶</a></h2>
<p>Data classification considers the problem of
partitioning the attribute values into mutually exclusive and exhaustive
groups. The precise manner in which this is done will be a function of the
measurement scale of the attribute in question. For quantitative attributes
(ordinal, interval, ratio scales) the classes will have an explicit ordering.
More formally, the classification problem is to define class boundaries such
that
<span class="math notranslate nohighlight">\($
c_j &lt; y_i \le  c_{j+1} \ \forall y_i \in C_{j}
$\)</span>
where <span class="math notranslate nohighlight">\(y_i\)</span> is the
value of the attribute for spatial location <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span> is a class index, and <span class="math notranslate nohighlight">\(c_j\)</span>
represents the lower bound of interval <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>Different classification schemes obtain from their definition of the class
boundaries. The choice of the classification scheme should take into
consideration the statistical distribution of the attribute values.</p>
<p>To illustrate these considerations, we will examine regional income data for the
32 Mexican states. The variable we focus on is per capita gross domestic product
for 1940 (PCGDP1940):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mx</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;../data/mexico/mexicojoin.shp&quot;</span><span class="p">)</span>
<span class="n">mx</span><span class="p">[[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;PCGDP1940&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>Which displays the following statistical distribution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
<p>As we can see, the distribution is positively skewed as in common in regional income studies. In other words,
the mean exceeds the median (<code class="docutils literal notranslate"><span class="pre">50%</span></code>, in the table below), leading the to fat right tail in the figure. As
we shall see, this skewness will have implications for the choice of choropleth
classification scheme.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<p>For quantitative attributes we first sort the data by their value,
such that <span class="math notranslate nohighlight">\(x_0 \le x_2 \ldots \le x_{n-1}\)</span>. For a prespecified number of classes
<span class="math notranslate nohighlight">\(k\)</span>, the classification problem boils down to selection of <span class="math notranslate nohighlight">\(k-1\)</span> break points
along the sorted values that separate the values into mutually exclusive and
exhaustive groups.</p>
<p>In fact, the determination of the histogram above can
be viewed as one approach to this selection.
The method <code class="docutils literal notranslate"><span class="pre">seaborn.distplot</span></code> uses the matplotlib <code class="docutils literal notranslate"><span class="pre">hist</span></code>
function under the hood to determine the class boundaries and the counts of
observations in each class. In the figure, we have five classes which can be
extracted with an explicit call to the <code class="docutils literal notranslate"><span class="pre">hist</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">counts</span></code> object captures how many observations each category in the classification has:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">bin</span></code> object stores these break points we are interested in when considering classification schemes (the <code class="docutils literal notranslate"><span class="pre">patches</span></code> object can be ignored in this context, as it stores the geometries of the histogram plot):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span>
</pre></div>
</div>
<p>This yields 5 bins, with the first having a lower bound of 1892 and an upper
bound of 5985.8 which contains 17 observations.
The determination of the
interval width (<span class="math notranslate nohighlight">\(w\)</span>) and the number of bins in <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> is based on the Freedman-Diaconis rule:</p>
<div class="math notranslate nohighlight">
\[w = 2 * IQR * n^{-1/3}\]</div>
<p>where <span class="math notranslate nohighlight">\(IQR\)</span> is the inter quartile
range of the attribute values. Given <span class="math notranslate nohighlight">\(w\)</span> the number of bins (<span class="math notranslate nohighlight">\(k\)</span>) is:</p>
<div class="math notranslate nohighlight">
\[k=(max-
min)/w.\]</div>
<p>Below we present several approaches to create these break points that follow criteria that can be of interest in different contexts, as they focus on different priorities.</p>
<div class="section" id="equal-intervals">
<h3>Equal Intervals<a class="headerlink" href="#equal-intervals" title="Permalink to this headline">¶</a></h3>
<p>The Freedman-Diaconis approach provides a rule to determine the width and, in
turn, the number of bins for the classification. This is a special case of a
more general classifier known as “equal intervals”, where each of the bins has
the same width in the value space. For a given value of <span class="math notranslate nohighlight">\(k\)</span>, equal intervals
classification splits the range of the attribute space into <span class="math notranslate nohighlight">\(k\)</span> equal length
intervals, with each interval having a width <span class="math notranslate nohighlight">\(w = \frac{x_0 - x_{n-1}}{k}\)</span>. Thus
the maximum class is <span class="math notranslate nohighlight">\((x_{n-1}-w, x_{n-1}]\)</span> and the first class is <span class="math notranslate nohighlight">\((-\infty,
x_{n-1} - (k-1)w]\)</span>.</p>
<p>Equal intervals have the dual advantages of simplicity and ease of
interpretation. However, this rule only considers the extreme values of the
distribution and, in some cases, this can result in one or more classes being
sparse. This is clearly the case in our income dataset, as the majority of the
values are placed into the first two classes leaving the last three classes
rather sparse:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ei5</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">EqualInterval</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ei5</span>
</pre></div>
</div>
<p>Note that each of the intervals, however, has equal width of
<span class="math notranslate nohighlight">\(w=4093.8\)</span>. This value of <span class="math notranslate nohighlight">\(k=5\)</span> also coincides with the default classification
in the Seaborn histogram displayed in Figure 1. It should also be noted that the first class is closed on the lower bound,
in contrast to the general approach defined in Equation (1).</p>
</div>
<div class="section" id="quantiles">
<h3>Quantiles<a class="headerlink" href="#quantiles" title="Permalink to this headline">¶</a></h3>
<p>To avoid the potential problem of sparse classes, the quantiles of
the distribution can be used to identify the class boundaries. Indeed, each
class will have approximately <span class="math notranslate nohighlight">\(\mid\frac{n}{k}\mid\)</span> observations using the quantile
classifier. If <span class="math notranslate nohighlight">\(k=5\)</span> the sample quintiles are used to define the upper limits of
each class resulting in the following classification:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q5</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">Quantiles</span><span class="p">(</span><span class="n">mx</span><span class="o">.</span><span class="n">PCGDP1940</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">q5</span>
</pre></div>
</div>
<p>Note that while the numbers of values in each class are roughly equal, the
widths of the first four intervals are rather different:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q5</span><span class="o">.</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">-</span><span class="n">q5</span><span class="o">.</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>While quantiles does avoid the pitfall of sparse classes, this classification is
not problem free. The varying widths of the intervals can be markedly different
which can lead to problems of interpretation. A second challenge facing quantiles
arises when there are a large number of duplicate values in the distribution
such that the limits for one or more classes become ambiguous. For example, if one had a variable with <span class="math notranslate nohighlight">\(n=20\)</span> but 10 of the observations took on the same value which was the minimum observed, then for values of <span class="math notranslate nohighlight">\(k&gt;2\)</span>, the class boundaries become ill-defined since a simple rule of splitting at the <span class="math notranslate nohighlight">\(n/k\)</span> ranked observed value would depend upon how ties are treated when ranking.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ties</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">Quantiles</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ties</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ux</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ux</span>
</pre></div>
</div>
<p>In this case, <code class="docutils literal notranslate"><span class="pre">mapclassify</span></code> will issue a warning alerting the user to the issue that this sample does not contain enough unique values to form
the number of well-defined classes requested.  It then forms a lower number of classes using pseudo quantiles, or quantiles defined on the unique values in the sample, and then uses the pseudo quantiles to classify all the values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span> <span class="o">=</span> <span class="n">numpy</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">w</span> <span class="o">=</span> <span class="mf">100.0</span> <span class="o">/</span> <span class="n">k</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">100</span><span class="o">+</span><span class="n">w</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pct</span><span class="p">)</span> <span class="k">for</span> <span class="n">pct</span> <span class="ow">in</span> <span class="n">p</span><span class="p">])</span>
<span class="n">q</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">stats</span><span class="o">.</span><span class="n">scoreatpercentile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pct</span><span class="p">)</span> <span class="k">for</span> <span class="n">pct</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">20</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="section" id="mean-standard-deviation">
<h3>Mean-standard deviation<a class="headerlink" href="#mean-standard-deviation" title="Permalink to this headline">¶</a></h3>
<p>Our third classifer uses the sample mean <span class="math notranslate nohighlight">\(\bar{x} =
\frac{1}{n} \sum_{i=1}^n x_i\)</span> and sample standard deviation <span class="math notranslate nohighlight">\(s = \sqrt{
\frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})  }\)</span> to define class boundaries as
some distance from the sample mean, with the distance being a multiple of the
standard deviation. For example, a common definition for <span class="math notranslate nohighlight">\(k=5\)</span> is to set the
upper limit of the first class to two standard deviations (<span class="math notranslate nohighlight">\(c_{0}^u = \bar{x} - 2 s\)</span>), and the intermediate
classes to have upper limits within one standard deviation (<span class="math notranslate nohighlight">\(c_{1}^u = \bar{x}-s,\ c_{2}^u = \bar{x}+s, \ c_{3}^u
= \bar{x}+2s\)</span>). Any values greater (smaller) than two standard deviations above (below) the mean
are placed into the top (bottom) class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">msd</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">StdMean</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">])</span>
<span class="n">msd</span>
</pre></div>
</div>
<p>This classifier is best used when data is normally distributed or, at least, when the sample mean is a meaningful measure to anchor the classification around. Clearly this is
not the case for our income data as the positive skew results in a loss of
information when we use the standard deviation. The lack of symmetry leads to
an inadmissible upper bound for the first  class as well as a concentration of the
vast majority of values in the middle class.</p>
</div>
<div class="section" id="maximum-breaks">
<h3>Maximum Breaks<a class="headerlink" href="#maximum-breaks" title="Permalink to this headline">¶</a></h3>
<p>The maximum breaks classifier decides where to set the break points between
classes by considering the difference between sorted values. That is, rather
than considering a value of the dataset in itself, it looks at how appart each
value is from the next one in the sorted sequence. The classifier then places
the the <span class="math notranslate nohighlight">\(k-1\)</span> break points in between the pairs of values most stretched apart from
each other in the entire sequence, proceeding in descending order relative to
the size of the breaks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mb5</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">MaximumBreaks</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">mb5</span>
</pre></div>
</div>
<p>Maximum breaks is an appropriate approach when we are interested in making sure
observations in each class are separated from those in neighboring classes. As
such, it works well in cases where the distribution of values is not unimodal.
In addition, the algorithm is relatively fast to compute. However, its
simplicitly can sometimes cause unexpected results. To the extent in only
considers the top <span class="math notranslate nohighlight">\(k-1\)</span> differences between consecutive values, other more nuanced
within-group differences and dissimilarities can be ignored.</p>
</div>
<div class="section" id="box-plot">
<h3>Box-Plot<a class="headerlink" href="#box-plot" title="Permalink to this headline">¶</a></h3>
<p>The box-plot classification is a blend of the quantile and
standard deviation classifiers. Here <span class="math notranslate nohighlight">\(k\)</span> is predefined to six, with the upper limit of class 0 set
to <span class="math notranslate nohighlight">\(q_{0.25}-h \, IQR\)</span>. <span class="math notranslate nohighlight">\(IQR = q_{0.75}-q_{0.25}\)</span> is the
inter-quartile range; <span class="math notranslate nohighlight">\(h\)</span> corresponds to the hinge, or the multiplier of the <span class="math notranslate nohighlight">\(IQR\)</span> to obtain the bounds of the whiskers. The lower limit of the sixth class is set to <span class="math notranslate nohighlight">\(q_{0.75}+h \,
IQR\)</span>. Intermediate classes have their upper limits set to the 0.25, 0.50 and
0.75 percentiles of the attribute values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bp</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">BoxPlot</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">])</span>
<span class="n">bp</span>
</pre></div>
</div>
<p>Any values falling into either of the extreme classes are defined as outlers.
Note that because the income values are non-negative by definition, the lower
outlier class has an inadmissible upper bound meaning that lower outliers would
not be possible for this sample.</p>
<p>The default value for the hinge is <span class="math notranslate nohighlight">\(h=1.5\)</span> in
PySAL. However, this can be specified by the user for an alternative classification:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bp1</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">BoxPlot</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">],</span> <span class="n">hinge</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bp1</span>
</pre></div>
</div>
<p>Doing so will affect the definition of the outlier classes, as well as the
neighboring internal classes.</p>
</div>
<div class="section" id="head-tail-breaks">
<h3>Head-Tail Breaks<a class="headerlink" href="#head-tail-breaks" title="Permalink to this headline">¶</a></h3>
<p>The head tail algorithm, introduced by Jiang (2013), is based on a recursive partioning of the data using splits around
iterative means. The splitting process continues until the distributions within each of
the classes no longer display a heavy-tailed distribution in the sense that
there is a balance between the number of smaller and larger values assigned to
each class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ht</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">HeadTailBreaks</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">])</span>
<span class="n">ht</span>
</pre></div>
</div>
<p>For data with a heavy-tailed distribution, such as power law and log normal
distributions, the head tail breaks classifier (Jiang 2015) can be particularly
effective.</p>
</div>
<div class="section" id="jenks-caspall">
<h3>Jenks Caspall<a class="headerlink" href="#jenks-caspall" title="Permalink to this headline">¶</a></h3>
<p>This approach, as well as the following two, tackles the calssification challenge from a heuristic perspective, rather than from deterministic one. Originally proposed by Jenks &amp; Caspall (1971), this algorithm aims to minimize the sum of absolute deviations around
class means. The approach begins with a prespecified number of classes and an
arbitrary initial set of class breaks - for example using quintiles. The
algorithm attempts to improve the objective function by considering the movement
of observations between adjacent classes. For example, the largest value in the
lowest quintile would be considered for movement into the second quintile, while
the lowest value in the second quintile would be considered for a possible move
into the first quintile. The candidate move resulting in the largest reduction
in the objective function would be made, and the process continues until no
other improving moves are possible.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">jc5</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">JenksCaspall</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">jc5</span>
</pre></div>
</div>
</div>
<div class="section" id="fisher-jenks">
<h3>Fisher Jenks<a class="headerlink" href="#fisher-jenks" title="Permalink to this headline">¶</a></h3>
<p>The second optimal algorithm adopts a dynamic programming approach to minimize
the sum of the absolute deviations around class medians. In contrast to the
Jenks-Caspall approach, Fisher-Jenks is guaranteed to produce an optimal
classification for a prespecified number of classes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">fj5</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">FisherJenks</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">fj5</span>
</pre></div>
</div>
</div>
<div class="section" id="max-p">
<h3>Max-p<a class="headerlink" href="#max-p" title="Permalink to this headline">¶</a></h3>
<p>Finally, the max-p classifiers adopts the algorithm underlying the max-p region
building method (Duque, Anselin and Rey, 2012) to the case of map classification. It is similar in spirit to
Jenks Caspall in that it considers greedy swapping between adjacent classes to
improve the objective function. It is a heuristic, however, so unlike
Fisher-Jenks, there is no optimial solution guaranteed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mp5</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">MaxP</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">mp5</span>
</pre></div>
</div>
</div>
<div class="section" id="comparing-classification-schemes">
<h3>Comparing Classification schemes<a class="headerlink" href="#comparing-classification-schemes" title="Permalink to this headline">¶</a></h3>
<p>As a special case of clustering, the definition of
the number of classes and the class boundaries pose a problem to the map
designer. Recall that the Freedman-Diaconis rule was said to be optimal,
however, the optimality necessitates the specification of an objective function.
In the case of Freedman-Diaconis, the objective function is to minimize the
difference between the area under estimated kernel density based on the sample
and the area under the theoretical population distribution that generated the
sample.</p>
<p>This notion of statistical fit is an important one. However, it is not the
only consideration when evaluating classifiers for the purpose of choropleth
mapping. Also relevant is the spatial distribution of the attribute values and
the ability of the classifier to convey a sense of that spatial distribution. As
we shall see, this is not necessarily directly related to the statistical
distribution of the attribute values. We will return to a joint consideration of both
the statistical and spatial distribution of the attribute values in comparison
of classifiers below.</p>
<p>For map classification, one optimiality criterion that
can be used is a measure of fit. In PySAL the “absolute deviation around class
medians” (ADCM) is calculated and provides a measure of fit that allows for
comparison of alternative classifiers for the same value of <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>To see this, we can compare different classifiers for <span class="math notranslate nohighlight">\(k=5\)</span> on the Mexico data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">class5</span> <span class="o">=</span> <span class="n">q5</span><span class="p">,</span> <span class="n">ei5</span><span class="p">,</span> <span class="n">ht</span><span class="p">,</span> <span class="n">mb5</span><span class="p">,</span> <span class="n">msd</span><span class="p">,</span> <span class="n">fj5</span><span class="p">,</span> <span class="n">jc5</span>
<span class="n">fits</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">c</span><span class="o">.</span><span class="n">adcm</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">class5</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">fits</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;classifier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">class5</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ADCM&#39;</span><span class="p">,</span> <span class="s1">&#39;Classifier&#39;</span><span class="p">]</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Classifier&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;ADCM&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>As is to be expected, the Fisher-Jenks classifier dominates all other k=5
classifiers with an ACDM of 23,729. Interestingly, the equal interval classifier
performs well despite the problems associated with being sensitive to the
extreme values in the distribution. The mean-standard deviation classifier has a
very poor fit due to the skewed nature of the data and the concentrated
assignment of the majority of the observations to the central class.</p>
<p>The ADCM provides a global measure of fit which can be used to compare the
alternative classifiers. As a complement to this global perspective, it can be
revealing to consider how each of the spatial observations was classified across
the alternative approaches. To do this we can add the class bin attribute (<code class="docutils literal notranslate"><span class="pre">yb</span></code>)
generated by the PySAL classifiers as additional columns in the data frame and
present these jointly in a table:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;q540&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">q5</span><span class="o">.</span><span class="n">yb</span>
<span class="n">mx</span><span class="p">[</span><span class="s1">&#39;ei540&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ei5</span><span class="o">.</span><span class="n">yb</span>
<span class="n">mx</span><span class="p">[</span><span class="s1">&#39;ht40&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ht</span><span class="o">.</span><span class="n">yb</span>
<span class="n">mx</span><span class="p">[</span><span class="s1">&#39;mb540&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mb5</span><span class="o">.</span><span class="n">yb</span>
<span class="n">mx</span><span class="p">[</span><span class="s1">&#39;msd40&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">yb</span>
<span class="n">mx</span><span class="p">[</span><span class="s1">&#39;fj540&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fj5</span><span class="o">.</span><span class="n">yb</span>
<span class="n">mx</span><span class="p">[</span><span class="s1">&#39;jc540&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">jc5</span><span class="o">.</span><span class="n">yb</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mxs</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">highlight_values</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">val</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;background-color: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;#ffffff&#39;</span>
    <span class="k">elif</span> <span class="n">val</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;background-color: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;#e0ffff&#39;</span>
    <span class="k">elif</span> <span class="n">val</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;background-color: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;#b3ffff&#39;</span>
    <span class="k">elif</span> <span class="n">val</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;background-color: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;#87ffff&#39;</span>
    <span class="k">elif</span> <span class="n">val</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;background-color: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;#62e4ff&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">mxs</span><span class="p">[[</span><span class="s1">&#39;NAME&#39;</span><span class="p">,</span> <span class="s1">&#39;PCGDP1940&#39;</span><span class="p">,</span> <span class="s1">&#39;q540&#39;</span><span class="p">,</span> <span class="s1">&#39;ei540&#39;</span><span class="p">,</span> <span class="s1">&#39;ht40&#39;</span><span class="p">,</span> <span class="s1">&#39;mb540&#39;</span><span class="p">,</span> <span class="s1">&#39;msd40&#39;</span><span class="p">,</span> <span class="s1">&#39;fj540&#39;</span><span class="p">,</span> <span class="s1">&#39;jc540&#39;</span><span class="p">]]</span>
<span class="n">t</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">highlight_values</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># write table out to tex</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;classtable.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
    <span class="n">t</span><span class="o">.</span><span class="n">to_latex</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
<p>Inspection of this table reveals a number of interesting results. First, the
only Mexican state that is treated consistantly across the k=5 classifiers is
Baja California Norte which is placed in the highest class by all classifiers.
Second, the mean-standard deviation classifier has an empty first class due to
the inadmissible upper bound and the overconcentration of values in the central
class (2).</p>
<p>Finally, we can consider a meso-level view of the clasification
results by comparing the number of values assigned to each class across the
different classifiers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">counts</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">class5</span><span class="p">},</span>
                 <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Class-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>
</pre></div>
</div>
<p>Doing so highlights the similarities between Fisher Jenks and equal intervals as
the distribution counts are very similar as the two approaches agree on all 17
states assigned to the first class. Indeed, the only observation that
distinguishes the two classifiers is the treatment of Baja California Sur which
is kept in class 1 in equal intervals, but assigned to class 2 by Fisher Jenks.</p>
</div>
</div>
<div class="section" id="color">
<h2>Color<a class="headerlink" href="#color" title="Permalink to this headline">¶</a></h2>
<p>Having considered the evaluation of the statisitcal distribution of
the attribute values and the alternative classification approaches, the next
step is to select the symbolization and color scheme. Together with the choice of classifier, these will determine the overall
effectiveness of the choropleth map in representing the spatial
distribution of the attribute values.</p>
<p>Let us start by refreshing the <code class="docutils literal notranslate"><span class="pre">mx</span></code> object and exploring the base polygons for the Mexican states:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mx</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;../data/mexico/mexicojoin.shp&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">mx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Mexican States&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Prior to examining the attribute values it is important to note that the
spatial units for these states are far from homogenous in their shapes and
sizes. This can have major impacts on our brain’s pattern recognition capabilities
as we tend to be drawn to the larger polygons. Yet, when we considered the
statistical distribution above, each observation was given equal weight. Thus,
the spatial distribution becomes more complicated to evaluate from a visual and
statistical perspective.</p>
<p>With this qualification in mind, we will explore the construction of choropleth
maps using geopandas:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mx</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;../data/mexico/mexicojoin.shp&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">mx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that the default for the legend is two report two decimal places. If we desire, this can be changed by overriding the <code class="docutils literal notranslate"><span class="pre">fmt</span></code> parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">mx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The default color map used by geopandas is viridis, which is a multi-hue sequential scheme, with the darker (ligher) hues representing lower (higher) values for the attribute in question. The choice of a color scheme for a choropleth map should be based on the type of variable underconsideration. Generally, a distinction is drawn between three types of numerical attributues:</p>
<ul class="simple">
<li><p>sequential</p></li>
<li><p>diverging</p></li>
<li><p>qualitative</p></li>
</ul>
<div class="section" id="sequential-color-schemes">
<h3>Sequential Color Schemes<a class="headerlink" href="#sequential-color-schemes" title="Permalink to this headline">¶</a></h3>
<p>Our attribute is measured in dollars and is characterized as a <em>sequential</em> attribute. To choose an appropriate sequential scheme we can override the <code class="docutils literal notranslate"><span class="pre">cmap</span></code> parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">mx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="p">,</span> \
         <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>which now uses a single-hue sequent,ial color map with the lighter shades representing lower values. One difficulty with this map is that the poor states in the southern portion of Mexico blend into the background of the map display. This can be adjusted by overriding the <code class="docutils literal notranslate"><span class="pre">edgecolor</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">mx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;Quantiles&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span><span class="p">,</span> \
         <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="diverging-color-schemes">
<h3>Diverging Color Schemes<a class="headerlink" href="#diverging-color-schemes" title="Permalink to this headline">¶</a></h3>
<p>A slightly different type of attribute is the so-called “diverging” values attribute. This is
useful when one wishes to place equal emphasis on mid-range critical values as
well as extremes at both ends of the distribution. Light colors are used to
emphasize the mid-range class while dark colors with contrasting hues are used
to distinguish the low and high extremes.</p>
<p>To illustrate this for the Mexican
income data we can derive a new variable which measures the change in a state’s
rank in the income distribution between 1940 to 2000:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rnk</span> <span class="o">=</span> <span class="n">mx</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># ascending ranks 1=high, n=lowest</span>
<span class="n">rnk</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;NAME&#39;</span><span class="p">]</span>
<span class="n">delta_rnk</span> <span class="o">=</span> <span class="n">rnk</span><span class="o">.</span><span class="n">PCGDP1940</span> <span class="o">-</span> <span class="n">rnk</span><span class="o">.</span><span class="n">PCGDP2000</span>
<span class="n">delta_rnk</span>
<span class="bp">cls</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">delta_rnk</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="bp">cls</span>
</pre></div>
</div>
<p>Here we have created four classes for the rank changes: [-inf, -5), [-5, 0), [0,
5), [5, 20]. Note that these are descending ranks, so the wealthiest state in
any period has a rank of 1 and therefore when considering the change in ranks, a
negative change reflects moving down the income distribution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">mx</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">cl</span><span class="o">=</span><span class="bp">cls</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="s1">&#39;cl&#39;</span><span class="p">,</span> <span class="n">categorical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdYlBu&#39;</span><span class="p">,</span>
           <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;equal_interval&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PCGDP1940&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
<p>Here the red (blue) hues are states that have moved downwards (upwards) in the
income distribution, with the darker hue representing a larger movement.</p>
</div>
<div class="section" id="qualitative-color-schemes">
<h3>Qualitative Color Schemes<a class="headerlink" href="#qualitative-color-schemes" title="Permalink to this headline">¶</a></h3>
<p>The Mexico data set also has several variables that
are on a nominal measurement scale. One of these is a region definition variable
that groups individual states in contiguous clusters of similar characteristics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;HANSON98&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>This regionalization scheme partions Mexico into 5 regions. A naive (and
incorrect) way to display this would be to treat the region variable as
sequential and use a <code class="docutils literal notranslate"><span class="pre">UserDefined</span></code> classifier to display the regions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">h5</span> <span class="o">=</span> <span class="n">mapclassify</span><span class="o">.</span><span class="n">UserDefined</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="s1">&#39;HANSON98&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="n">h5</span><span class="o">.</span><span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{:.0f}</span><span class="s1">&#39;</span>
<span class="n">h5</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">h5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span> <span class="n">axis_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>This is not correct because the region variable is not on an interval scale, so
the differences between the values have no quantitative significance but rather
the values simply indicate region membership. However, the choropleth above gives
a clear visual cue that regions in the south have larger values
than those in the north, as the color map implies an intensity gradient.</p>
<p>A more appropriate visualization
is to use a “qualitative” color palette:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">h5</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Pastel1&#39;</span><span class="p">,</span> <span class="n">axis_on</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>In this chapter we have considered the construction of choropleth maps for
spatial data visualization. The key issues of the choice of classification
scheme, variable measurement scale, spatial configuration and color palettes
were illustrated using PySAL’s map classification module together with other
related packages in the PyData stack.</p>
<p>Choropleth maps are a central tool in the geographic data science arsenal as
they provide powerful visualizations of the spatial distribution of attribute
values. We have only touched on the basic concepts in this chapter, as there is
much more that can be said about cartographic theory and the design of effective
choropleth maps. Readers interested in pursuing this literature are encouraged
to see the references cited.</p>
<p>At the same time, given the philosophy underlying PySAL the methods we cover
here are sufficient for exploratory data analysis where the rapid and flexible
generation of views is critical to the work flow. Once the analysis is complete,
and the final presentation quality maps are to be generated, there are excellent
packages in the data stack that the user can turn to.</p>
</div>
<div class="section" id="questions">
<h2>Questions<a class="headerlink" href="#questions" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>A variable such as population density measured for census tracts in a metropolitan area can display a high degree of skewness. What is an appropriate choice for a choropleth classification for such a variable?</p></li>
<li><p>Provide two solutions to the problem of ties when applying quantile classification to the following series: <span class="math notranslate nohighlight">\(y=[2,2,2,2,2,2,4,7,8,9,20,21]\)</span> and <span class="math notranslate nohighlight">\(k=4\)</span>. Discuss the merits of each approach.</p></li>
<li><p>Which classifiers are appropriate for data that displays a high degree of multi-modality in its statistical distribution?</p></li>
<li><p>Contrast and compare classed choropleth maps with class-less choropleth maps? What are the strengths and limitations of each type of visualization for spatial data?</p></li>
<li><p>In what ways do choropleth classifiers treat intra-class and inter-class heterogeneity differently? What are the implications of these choices?</p></li>
<li><p>To what extent do most commonly employed choropleth classification methods take the geographical distribution of the variable into consideration? Can you think of ways to incorporate the spatial features of a variable into a classification?</p></li>
<li><p>Discuss the similarities between  the choice of the number of classes in choropleth mapping, on the one hand, and the determination of the number of clusters in a data set on the other. What aspects of choropleth mapping differentiate the former from the latter?</p></li>
<li><p>The Fisher-Jenks classifier will always dominate other k-classifiers for a given data set, with respect to statistical fit. Given this, why might one decide on choosing a different k-classifier for a particular data set?</p></li>
</ol>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Duque, J.C., L. Anselin, and S.J. Rey. (2012) “The max-p regions problem.” <em>Journal of Regional Science</em>, 52:397-419.</p>
<p>Jenks, G. F., &amp; Caspall, F. C. (1971). Error on choroplethic maps: definition, measurement, reduction. Annals of the Association of American Geographers, 61(2), 217-244.</p>
<p>Jian, B. (2013) “Head/Tail Breaks: A New Classification Scheme for Data with a Heavy-Tailed Distribution.” <em>The Professional Geographer</em>, 65(3): 482-494.</p>
<p>Jiang, Bin. (2015) “Head/tail breaks for visualization of city
structure and dynamics.” <em>Cities</em>, 43: 69-77.</p>
<p>Rey, S.J. and M.L. Guitierez. (2010)
“Interregional inequality dynamics in Mexico.” <em>Spatial Economic Analysis</em>, 5:
277-298.</p>
<hr class="docutils" />
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content/bD"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dani Arribas-Bel<br/>
        
          <div class="extra_footer">
            <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">A course on Geographic Data Science</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://darribas.org" property="cc:attributionName" rel="cc:attributionURL">Dani Arribas-Bel</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>